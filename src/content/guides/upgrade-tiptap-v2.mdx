---
tags:
  - type: editor
title: How to upgrade Tiptap v2 to v3
meta:
  title: Upgrade v2 to v3 | Tiptap Collaboration Docs
  description: Upgrade your Tiptap v2 project to version 3. Learn about the changes and how to migrate your project.
  category: Collaboration
---

# Tiptap v3 Migration Guide

Tiptap v3 is a major update with breaking changes. This guide will help you upgrade your Tiptap v2 project to version 3.

## Breaking Changes

### Package Changes

- UMD builds have been removed (now using tsup)

### Menu Systems

Tippy.js has been replaced with Floating UI for all floating elements. This affects:

- @tiptap/extension-floating-menu
- @tiptap/extension-bubble-menu
- @tiptap/extension-mention
- @tiptap/suggestion

Example migration:

```tsx
// Before
import { BubbleMenu } from '@tiptap/react'

const menu = <BubbleMenu tippyOptions={{ duration: 100 }}>{/* menu content */}</BubbleMenu>

// After
import { BubbleMenu } from '@tiptap/react/menus'
import { offset } from '@floating-ui/dom'
const menu = (
  <BubbleMenu
    options={{
      middleware: [offset(6)],
      placement: 'top',
    }}
  >
    {/* menu content */}
  </BubbleMenu>
)
```

- New required dependency: `@floating-ui/dom`. Install it with:

```bash
npm install @floating-ui/dom@^1.6.0
```

### API Changes Text Style Updates

- `mergeNestedSpanStyles` now defaults to `true`
- New text style extensions added:
  - `font-size`
  - `background-color`
  - `line-height`
- `TextStyleKit` API available for configuring multiple extensions

You can now use the new `TextStyleKit` for easier configuration:

```ts
import { TextStyleKit } from '@tiptap/extension-text-style'

new Editor({
  extensions: [
    TextStyleKit.configure({
      backgroundColor: {
        types: ['textStyle'],
      },
      color: {
        types: ['textStyle'],
      },
      fontFamily: {
        types: ['textStyle'],
      },
      fontSize: {
        types: ['textStyle'],
      },
      lineHeight: {
        types: ['textStyle'],
      },
    }),
  ],
})
```

### Command Changes

- `clearContent` and `setContent` now emit updates by default
- `setContent` signature changed to (content, options)
- `insertContent` behavior modified to prevent splitting text nodes at the beginning

### NodeView Changes

The `getPos` function in NodeViewRendererProps can now return `undefined`. Update your code to handle this case:

```ts
// Before
const pos = nodeViewProps.getPos()

// After
const pos = nodeViewProps.getPos()
if (pos !== undefined) {
  // use pos
}
```

### Removed Features

- `editor.getCharacterCount()` method has been removed
- `considerAnyAsEmpty` option removed from placeholder extension

## New Features

### Extensions Package

New @tiptap/extensions package combines multiple utility extensions:

- CharacterCount
- DropCursor
- GapCursor
- History
- Placeholder
- TrailingNode
- Focus
- Selection

Example migration:

```diff
- import CharacterCount from '@tiptap/extension-character-count'
+ import { CharacterCount } from '@tiptap/extensions'
```

### Server-Side Rendering

Improved SSR support with the ability to run the editor on the server-side without rendering:

```ts
const editor = new Editor({
  element: null, // opt-in to SSR
  content: {
    type: 'doc',
    content: [
      /* ... */
    ],
  },
  extensions: [
    /* ... */
  ],
})
```

### Mark Views

Adds support for [markviews](https://prosemirror.net/docs/ref/#view.MarkView), which allow you to render custom views for marks within the editor. This is useful for rendering custom UI for marks, like a color picker for a text color mark or a link editor for a link mark.

Including support for React and Vue 3 frameworks

```ts
// Plain JS
import { Mark } from '@tiptap/core'

Mark.create({
  // Other options...
  addMarkView() {
    return ({ mark, HTMLAttributes }) => {
      const dom = document.createElement('b')
      const contentDOM = document.createElement('span')

      dom.appendChild(contentDOM)

      return {
        dom,
        contentDOM,
      }
    }
  },
})

// React
import { Mark } from '@tiptap/core'
import { ReactMarkViewRenderer } from '@tiptap/react'

Mark.create({
  // ... other options
  addMarkView() {
    return ReactMarkViewRenderer(YourComponent)
  },
})

// Vue 3
import { Mark } from '@tiptap/core'
import { VueMarkViewRenderer } from '@tiptap/vue-3'

Mark.create({
  addMarkView() {
    return VueMarkViewRenderer(Component)
  },
})
```

### Other Improvements

- New delete event tracking
- HTML parsing now uses happy-dom-without-node
- New node/mark attribute validation support
- Performance improvements for transaction handling

## StarterKit Updates

StarterKit now includes these extensions by default:

- Link
- ListKeymap
- Underline

If you've installed these separately, you can remove them:

```diff
- import Link from '@tiptap/extension-link'
- import ListKeymap from '@tiptap/extension-list-keymap'
- import Underline from '@tiptap/extension-underline'
```

## Migration Steps

1. Update Dependencies

   - Remove UMD-dependent code
   - Install `@floating-ui/dom` (for bubble & floating menus)
   - Update Tiptap packages to v3

2. Update Menu Implementations

   - Replace `tippyOptions` with Floating UI options
   - Update menu imports to use `/menus` suffix

3. Review NodeView Usage

   - Add checks for `undefined` `getPos`

4. Update Extensions

   - Migrate to `@tiptap/extensions` where applicable
   - Remove redundant `StarterKit` extensions
   - Update text style configurations

5. Review Command Usage

   - Update `setContent` calls to use new signature
   - Check `clearContent` behavior with default updates
