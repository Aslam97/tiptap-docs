---
title: Server-side tools (OpenAI Responses API)
meta:
  title: Server-side tools (OpenAI Responses API) | Tiptap Content AI
  description: Learn how to call tools in the server-side using the OpenAI Responses API.
  category: Content AI
---

This guide explains how to call tools in the server-side using the OpenAI Responses API. It presents an example of a tool that returns the weather in a given location.

First, define the tool in the [OpenAI Responses API tool format](https://platform.openai.com/docs/guides/function-calling?api-mode=responses#defining-functions):

```ts
const weatherTool = {
  type: 'function',
  function: {
    name: 'get_weather',
    description: 'Returns the weather in a given location',
    parameters: {
      type: 'object',
      properties: {
        location: {
          type: 'string',
          description: 'The location to get the weather for',
        },
      },
      required: ['location'],
    },
  },
}
```

Then, when you call the OpenAI API, include the tool in the `tools` array:

```ts
import {
  AiAgentToolkit,
  openaiResponsesAdapter,
  ChatMessagesFormatter,
} from '@tiptap-pro/extension-ai-agent-server'
import OpenAI from 'openai'

const toolkit = new AiAgentToolkit({
  adapter: openaiResponsesAdapter,
})

const formatter = new ChatMessagesFormatter({
  initialMessages: chatMessages,
  adapter: openaiResponsesAdapter,
})

// Initialize the OpenAI client
const openai = new OpenAI()

// Call the OpenAI Responses API
const response = await openai.responses.create({
  model: 'gpt-4.1',
  input: [
    {
      role: 'developer',
      content: `
<Your system prompt>
${toolkit.getSystemPrompt()}
`,
    },
    ...formatter.format(),
  ],
  // Include the weather tool in the tools array, beside
  // the other tools provided by AiAgentToolkit
  tools: [...toolkit.getTools(), weatherTool],
})
```

Then, check if the response contains the weather tool. If so, call the tool and add the result to the `llmMessages` array.

```ts
formatter.addAiResponse(response)
for (const toolCall of response.output) {
  if (toolCall.type !== 'function_call') {
    continue
  }

  const name = toolCall.name

  if (name !== 'get_weather') {
    continue
  }

  const args = JSON.parse(toolCall.arguments)

  const result = getWeather(args)
  formatter.addChatMessage({
    type: 'toolCallResult',
    toolName: 'get_weather',
    toolCallId: toolCall.call_id,
    result: result.toString(),
  })
}
```

Finally, when there are no more server-side tool calls, use the `formatter` to convert the response to the format expected by the AI Agent extension.

```ts
const response = formatter.getResolverResponse()
```

The `result` should be the response of the API endpoint, and the return value of the `resolver` function.
